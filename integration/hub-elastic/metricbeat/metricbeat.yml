#
# The Alluxio Open Foundation licenses this work under the Apache License, version 2.0
# (the "License"). You may not use this work except in compliance with the License, which is
# available at www.apache.org/licenses/LICENSE-2.0
#
# This software is distributed on an "AS IS" basis, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
# either express or implied, as more fully set forth in the License.
#
# See the NOTICE file distributed with this work for information regarding copyright ownership.
#

###################### Metricbeat Configuration #######################

# =========================== Modules configuration ============================
setup.ilm.enabled: false
setup.ilm.check_exists: false
setup.template.name: "metricbeat"
setup.template.pattern: "metricbeat-*"
metricbeat.config.modules:
  # Glob pattern for configuration loading
  path: ${path.config}/modules.d/*.yml

  # Set to true to enable config reloading
  reload.enabled: true

  # Period on which files under path should be checked for changes
  reload.period: 10s

# ======================= Elasticsearch template setting =======================

setup.template.settings:
  index.number_of_shards: 1
  index.codec: best_compression
  #_source.enabled: false

# ---------------------------- Elasticsearch Output ----------------------------
output.elasticsearch:
  hosts: ["${HUB_ES_ENDPOINT:?HUB_ES_ENDPOINT env var is not set}:${HUB_ES_PORT:?HUB_ES_PORT env var is not set}"]
  protocol: "https"
  username: "${HUB_ES_USERNAME:?HUB_ES_USERNAME env var is not set}"
  password: "${HUB_ES_PASSWORD:?HUB_ES_PASSWORD env var is not set}"
  index: "metricbeat-%{[agent.version]}-${HUB_CLUSTER_ID}"
  # ssl.verification_mode: none # Does not verify server's certificate. Do not use in a production environment

# ================================= Processors =================================

# Configure processors to enhance or manipulate events generated by the beat.

processors:
  - add_host_metadata: ~
  - add_cloud_metadata: ~
  - add_docker_metadata: ~
  - add_kubernetes_metadata: ~
