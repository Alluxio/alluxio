import{a as t,b as e,c as n,d as c,e as a,f as s,g as r,h as i,i as f,j as l,k as u,l as d,m as h,n as g,o as p,p as v,q as b,r as y,s as m,t as k,u as E,v as x,w as j,x as S,y as R,z as M,A as T,B as w,C as A,D as $,E as C,F as O,G as N,H as I,I as D,J as q,K as z,L,M as P,N as F,O as G,P as _,Q as B,R as H,S as J,T as K,U as Q,V as U,W as V,X as W,Y as X,Z as Y,_ as Z,$ as tt}from"./chunk-cbceff6d.js";export{a9 as buffers,o as CANCEL,aa as SAGA_LOCATION,ab as detach}from"./chunk-cbceff6d.js";const et=[];let nt=0;function ct(t){try{st(),t()}finally{rt()}}function ot(t){et.push(t),nt||(st(),it())}function at(t){try{return st(),t()}finally{it()}}function st(){nt++}function rt(){nt--}function it(){let t;for(rt();!nt&&void 0!==(t=et.shift());)ct(t)}const ft=t=>e=>t.some(t=>gt(t)(e)),lt=t=>e=>t(e),ut=t=>e=>e.type===t+"",dt=t=>e=>e.type===t,ht=()=>t;function gt(t){const o="*"===t?ht:e(t)?ut:n(t)?ft:c(t)?ut:a(t)?lt:s(t)?dt:null;if(null===o)throw Error(`invalid pattern: ${t}`);return o(t)}const pt={type:r},vt=t=>t&&t.type===r;function bt(t){void 0===t&&(t=i());let e=!1,n=[];return{take:function(c){e&&t.isEmpty()?c(pt):t.isEmpty()?(n.push(c),c.cancel=(()=>{h(n,c)})):c(t.take())},put:function(c){if(e)return;if(0===n.length)return t.put(c);n.shift()(c)},flush:function(n){e&&t.isEmpty()?n(pt):n(t.flush())},close:function(){if(e)return;e=!0;const t=n;n=[];for(let e=0,n=t.length;n>e;e++)(0,t[e])(pt)}}}function yt(t,e){void 0===e&&(e=f());let n,c=!1;const o=bt(e),s=()=>{c||(c=!0,a(n)&&n(),o.close())};return n=t(t=>{vt(t)?s():o.put(t)}),n=l(n),c&&n(),{take:o.take,flush:o.flush,close:s}}function mt(){let t=!1,e=[],n=e;const c=()=>{n===e&&(n=e.slice())},o=()=>{t=!0;const c=e=n;n=[],c.forEach(t=>{t(pt)})};return{[u]:!0,put(c){if(t)return;if(vt(c))return void o();const a=e=n;for(let t=0,e=a.length;e>t;t++){const e=a[t];e[d](c)&&(e.cancel(),e(c))}},take(e,o){void 0===o&&(o=ht),t?e(pt):(e[d]=o,c(),n.push(e),e.cancel=l(()=>{c(),h(n,e)}))},close:o}}function kt(){const t=mt(),e=t.put;return t.put=(t=>{t[g]?e(t):ot(()=>{e(t)})}),t}!function(t){var e,n=t.Symbol;"function"==typeof n?n.observable?e=n.observable:(e=n("observable"),n.observable=e):e="@@observable"}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")());var Et=function(){return Math.random().toString(36).substring(7).split("").join(".")};Et(),Et();const xt=0,jt=1,St=2,Rt=3;function Mt(t,e){const n=t[p];a(n)&&(e.cancel=n),t.then(e,t=>{e(t,!0)})}let Tt=0;var wt=()=>++Tt;function At(t){t.isRunning()&&t.cancel()}const $t={[v]:function(t,e,n){let c=e.channel,o=void 0===c?t.channel:c,a=e.pattern,s=e.maybe;const r=t=>{t instanceof Error?n(t,!0):!vt(t)||s?n(t):n(G)};try{o.take(r,O(a)?gt(a):null)}catch(t){return void n(t,!0)}n.cancel=r.cancel},[b]:function(t,e,n){let c=e.channel,o=e.action,a=e.resolve;ot(()=>{let e;try{e=(c?c.put:t.dispatch)(o)}catch(t){return void n(t,!0)}a&&C(e)?Mt(e,n):n(e)})},[y]:function(t,e,c,o){let a=o.digestEffect;const s=Tt,r=Object.keys(e);if(0===r.length)return void c(n(e)?[]:{});const i=q(e,c);r.forEach(t=>{a(e[t],s,i[t],t)})},[m]:function(t,e,c,o){let a=o.digestEffect;const s=Tt,r=Object.keys(e),i=n(e)?L(r.length):{},f={};let l=!1;r.forEach(t=>{const e=(e,n)=>{l||(n||B(e)?(c.cancel(),c(e,n)):(c.cancel(),l=!0,i[t]=e,c(i)))};e.cancel=D,f[t]=e}),c.cancel=(()=>{l||(l=!0,r.forEach(t=>f[t].cancel()))}),r.forEach(t=>{l||a(e[t],s,f[t],t)})},[k]:function(t,e,n,c){let o=e.context,a=e.fn,s=e.args,r=c.task;try{const e=a.apply(o,s);if(C(e))return void Mt(e,n);if(N(e))return void Gt(t,e,r.context,Tt,I(a),!1,n);n(e)}catch(t){n(t,!0)}},[E]:function(t,e,n){let c=e.context,o=e.fn,a=e.args;try{const t=(t,e)=>{_(t)?n(e):n(t,!0)};o.apply(c,a.concat(t)),t.cancel&&(n.cancel=t.cancel)}catch(t){n(t,!0)}},[x]:function(t,e,n,c){let o=e.fn,a=e.detached,s=c.task;const r=function(t){let e=t.context,n=t.fn,c=t.args;try{const t=n.apply(e,c);if(N(t))return t;let o=!1;return F(e=>o?{value:e,done:!0}:(o=!0,{value:t,done:!C(t)}))}catch(t){return F(()=>{throw t})}}({context:e.context,fn:o,args:e.args}),i=function(t,e){return t.isSagaIterator?{name:t.meta.name}:I(e)}(r,o);at(()=>{const e=Gt(t,r,s.context,Tt,i,a,D);a?n(e):e.isRunning()?(s.queue.addTask(e),n(e)):e.isAborted()?s.queue.abort(e.error()):n(e)})},[j]:function(t,e,c,o){let a=o.task;const s=(t,e)=>{if(t.isRunning()){const n={task:a,cb:e};e.cancel=(()=>{h(t.joiners,n)}),t.joiners.push(n)}else t.isAborted()?e(t.error(),!0):e(t.result())};if(n(e)){if(0===e.length)return void c([]);const t=q(e,c);e.forEach((e,n)=>{s(e,t[n])})}else s(e,c)},[S]:function(t,e,c,o){e===z?At(o.task):n(e)?e.forEach(At):At(e),c()},[R]:function(t,e,n){let c=e.selector,o=e.args;try{n(c(t.getState(),...o))}catch(t){n(t,!0)}},[M]:function(t,e,n){let c=e.pattern;const o=bt(e.buffer),a=gt(c),s=e=>{vt(e)||t.channel.take(s,a),o.put(e)},r=o.close;o.close=(()=>{s.cancel(),r()}),t.channel.take(s,a),n(o)},[T]:function(t,e,n,c){n(c.task.isCancelled())},[w]:function(t,e,n){e.flush(n)},[A]:function(t,e,n,c){n(c.task.context[e])},[$]:function(t,e,n,c){P(c.task.context,e),n()}};function Ct(t,e){return`${t}?${e}`}function Ot(t){const e=t.name,n=t.location;return n?`${e}  ${Ct(n.fileName,n.lineNumber)}`:e}function Nt(t){const e=H(t=>t.cancelledTasks,t);return e.length?["Tasks cancelled due to error:",...e].join("\n"):""}let It=null;const Dt=[],qt=t=>{t.crashedEffect=It,Dt.push(t)},zt=()=>{It=null,Dt.length=0},Lt=t=>{It=t},Pt=()=>{const t=Dt[0],e=Dt.slice(1),n=t.crashedEffect?function(t){const e=J(t);if(e)return`${e.code}  ${Ct(e.fileName,e.lineNumber)}`;return""}(t.crashedEffect):null;return[`The above error occurred in task ${Ot(t.meta)}${n?` \n when executing effect ${n}`:""}`,...e.map(t=>`    created by ${Ot(t.meta)}`),Nt(Dt)].join("\n")};function Ft(t,e,n,c,o,a,s){let r,i,f=xt,l=null;const u=[],d=Object.create(n),g=function(t,e,n){let c,o=[],a=!1;function s(t){e(),i(),n(t,!0)}function r(e){o.push(e),e.cont=((r,i)=>{a||(h(o,e),e.cont=D,i?s(r):(e===t&&(c=r),o.length||(a=!0,n(c))))})}function i(){a||(a=!0,o.forEach(t=>{t.cont=D,t.cancel()}),o=[])}return r(t),{addTask:r,cancelAll:i,abort:s,getTasks:()=>o}}(e,function(){u.push(...g.getTasks().map(t=>t.meta.name))},p);function p(e,n){if(n){if(f=St,qt({meta:o,cancelledTasks:u}),v.isRoot){const n=Pt();zt(),t.onError(e,{sagaStack:n})}i=e,l&&l.reject(e)}else e===Q?f=jt:f!==jt&&(f=Rt),r=e,l&&l.resolve(e);v.cont(e,n),v.joiners.forEach(t=>{t.cb(e,n)}),v.joiners=null}const v={[K]:!0,id:c,meta:o,isRoot:a,context:d,joiners:[],queue:g,cancel:function(){f===xt&&(f=jt,g.cancelAll(),p(Q,!1))},cont:s,end:p,setContext:function(t){P(d,t)},toPromise:function(){return l?l.promise:(l=function(){const t={};return t.promise=new Promise((e,n)=>{t.resolve=e,t.reject=n}),t}(),f===St?l.reject(i):f!==xt&&l.resolve(r),l.promise)},isRunning:()=>f===xt,isCancelled:()=>f===jt||f===xt&&e.status===jt,isAborted:()=>f===St,result:()=>r,error:()=>i};return v}function Gt(t,e,n,c,o,s,r){const i=t.finalizeRunEffect(function(e,n,c){if(C(e))Mt(e,c);else if(N(e))Gt(t,e,l.context,n,o,!1,c);else if(e&&e[W]){const n=$t[e.type];n(t,e.payload,c,u)}else c(e)});d.cancel=D;const f={meta:o,cancel:function(){f.status===xt&&(f.status=jt,d(Q))},status:xt},l=Ft(t,f,n,c,o,s,r),u={task:l,digestEffect:h};return r.cancel=l.cancel,d(),l;function d(t,n){try{let o;n?(o=e.throw(t),zt()):U(t)?(f.status=jt,d.cancel(),o=a(e.return)?e.return(Q):{done:!0,value:Q}):o=V(t)?a(e.return)?e.return():{done:!0}:e.next(t),o.done?(f.status!==jt&&(f.status=Rt),f.cont(o.value)):h(o.value,c,d)}catch(t){if(f.status===jt)throw t;f.status=St,f.cont(t,!0)}}function h(e,n,c,o){void 0===o&&(o="");const a=wt();let s;function r(n,o){s||(s=!0,c.cancel=D,t.sagaMonitor&&(o?t.sagaMonitor.effectRejected(a,n):t.sagaMonitor.effectResolved(a,n)),o&&Lt(e),c(n,o))}t.sagaMonitor&&t.sagaMonitor.effectTriggered({effectId:a,parentEffectId:n,label:o,effect:e}),r.cancel=D,c.cancel=(()=>{s||(s=!0,r.cancel(),r.cancel=D,t.sagaMonitor&&t.sagaMonitor.effectCancelled(a))}),i(e,a,r)}}function _t(t,e){let n=t.channel,c=void 0===n?kt():n,o=t.dispatch,a=t.getState,s=t.context,r=void 0===s?{}:s,i=t.sagaMonitor,f=t.effectMiddlewares,l=t.onError,u=void 0===l?Y:l;for(var d=arguments.length,h=Array(d>2?d-2:0),g=2;d>g;g++)h[g-2]=arguments[g];const p=e(...h),v=wt();let b;if(i&&(i.rootSagaStarted=i.rootSagaStarted||D,i.effectTriggered=i.effectTriggered||D,i.effectResolved=i.effectResolved||D,i.effectRejected=i.effectRejected||D,i.effectCancelled=i.effectCancelled||D,i.actionDispatched=i.actionDispatched||D,i.rootSagaStarted({effectId:v,saga:e,args:h})),f){const t=function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return 0===e.length?function(t){return t}:1===e.length?e[0]:e.reduce(function(t,e){return function(){return t(e.apply(void 0,arguments))}})}(...f);b=(e=>(n,c,o)=>{return t(t=>e(t,c,o))(n)})}else b=Z;const y={channel:c,dispatch:X(o),getState:a,sagaMonitor:i,onError:u,finalizeRunEffect:b};return at(()=>{const t=Gt(y,p,r,v,I(e),!0,D);return i&&i.effectResolved(v,t),t})}export default function(t){void 0===t&&(t={});let e,n=t,c=n.context,o=void 0===c?{}:c,a=n.channel,s=void 0===a?kt():a,r=n.sagaMonitor,i=function(t,e){if(null==t)return{};var n,c,o={},a=Object.keys(t);for(c=0;a.length>c;c++)0>e.indexOf(n=a[c])&&(o[n]=t[n]);return o}(n,["context","channel","sagaMonitor"]);function f(t){return e=_t.bind(null,tt({},i,{context:o,channel:s,dispatch:t.dispatch,getState:t.getState,sagaMonitor:r})),t=>e=>{r&&r.actionDispatched&&r.actionDispatched(e);const n=t(e);return s.put(e),n}}return f.run=function(){return e(...arguments)},f.setContext=(t=>{P(o,t)}),f}export{_t as runSaga,pt as END,vt as isEnd,yt as eventChannel,bt as channel,mt as multicastChannel,kt as stdChannel};
